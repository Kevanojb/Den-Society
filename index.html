<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Den Society — League & Eclectic</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body{font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .mono{font-variant-numeric:tabular-nums}
    .owner-only{display:none;}
    .owner-on .owner-only{display:block;}
    .chip{padding:.15rem .5rem;border-radius:.5rem;border:1px solid #e5e5e5;background:#fafafa}
  </style>
</head>
<body class="bg-neutral-50 text-neutral-900">
  <div id="root"></div>

  <script type="text/babel" data-presets="react">
    const {useState,useMemo,useEffect} = React;

    // ---------- Utils ----------
    const POINTS_TABLE=[20,17,15,13,11,9,8,7,6,5,4,3,2,1];
    const clamp=(n,lo,hi)=>Math.max(lo,Math.min(hi,n));
    const csvEscape=s=>{if(s==null)return"";const str=String(s);return /[",\n]/.test(str)?'"'+str.replace(/"/g,'""')+'"':str;};
    const downloadCSV=(filename,rows)=>{const csv=rows.map(r=>r.map(csvEscape).join(",")).join("\n");const blob=new Blob([csv],{type:"text/csv;charset=utf-8;"});const a=document.createElement("a");a.href=URL.createObjectURL(blob);a.download=filename;a.click();};
    const to1=x=>Math.round((Number(x)||0)*10)/10;

    // ---------- Handicap maths (local only) ----------
    function playingCapByGender(g){return g==="F"?36:28;}
    function rangeForHcap(h){if(h<=9)return"0-9";if(h<=18)return"10-18";if(h<=28)return"19-28";return"29-36";}
    function cutPerPointOver34(h){const r=rangeForHcap(h);return r==="0-9"?0.5:r==="10-18"?1:r==="19-28"?1:1.5;}
    function winnerBonusCut(h){const r=rangeForHcap(h);return r==="0-9"?1:r==="10-18"?2:r==="19-28"?2.5:3;}
    function computeNewExactHandicap(start,g,pts,b9,w){
      const startPlay=Math.round(start); let exact=start;
      if(pts>=35){exact-=cutPerPointOver34(startPlay)*(pts-34);}
      else if(pts<=31){exact+=0.5*(32-pts);}
      if(w) exact-=winnerBonusCut(startPlay);
      const max=playingCapByGender(g);
      const bounded=clamp(exact,0,60);
      const nextPlay=clamp(Math.round(bounded),0,max);
      return {nextExact:bounded,nextPlaying:nextPlay};
    }

    // ---------- CSV parsing ----------
    function splitSmart(raw){
      const d = raw.includes('\t')? '\t' : ',';
      return raw.split(d).map(s => (s||'').replace(/^"|"$/g,'').trim());
    }
    function toNum(x){
      const v = parseFloat(String(x==null?"":x).replace(/[^0-9.\-]/g,''));
      return Number.isFinite(v) ? v : NaN;
    }

    // STRICT Stableford per-hole: only 0..6, P or "\" => 0; ignore totals like 17/36/72
    function readStablefordPerHole(row){
      let start=-1;
      for(let i=0;i<row.length;i++){ if(String(row[i]).trim()==='Stableford'){ start=i; break; } }
      if(start<0) return null;
      const vals=[];
      for(let j=start+1;j<row.length && vals.length<18;j++){
        const raw=String(row[j]||'').trim();
        if(raw==='') continue;
        if(raw==='P' || raw==='p' || raw==='\\'){ vals.push(0); continue; }
        const n=parseFloat(raw.replace(/[^0-9.\-]/g,''));
        if(Number.isFinite(n) && n>=0 && n<=6){ vals.push(n); }
      }
      return vals.length>=18 ? vals.slice(0,18) : null;
    }

    // Detect Pars (Men & Women). If only one set found, use for both.
    function detectBothParsFromLines(lines){
      function scanParRow(row){
        const pars=[];
        for(let i=0;i<row.length;i++){
          const s=String(row[i]||'').trim();
          if(/^(par|pars|out|in|total)$/i.test(s)) continue;
          const r=Math.round(toNum(s));
          if(r===3||r===4||r===5){ pars.push(r); if(pars.length===18) break; }
        }
        return pars.length===18?pars:null;
      }
      const parRows = lines.filter(r => r.some(c=>/^pars?$/i.test(String(c).trim())));
      let detected=null;
      for(let i=0;i<parRows.length;i++){ const cand=scanParRow(parRows[i]); if(cand){detected=cand;break;} }
      if(!detected && parRows.length>=2){
        const nines=[];
        for(let r=0;r<parRows.length;r++){
          const nums=parRows[r].map(toNum).map(n=>Math.round(n)).filter(v=>v===3||v===4||v===5);
          if(nums.length>=9) nines.push(nums.slice(0,9));
        }
        if(nines.length>=2) detected=[].concat(nines[0],nines[1]).slice(0,18);
      }
      if(!detected){
        for(let r=0;r<lines.length;r++){
          const nums=lines[r].map(toNum).map(n=>Math.round(n)).filter(v=>v===3||v===4||v===5);
          if(nums.length>=18){ detected=nums.slice(0,18); break; }
        }
      }
      return {men: detected||null, women: detected||null};
    }

    function parseSquabbitCSV(text){
      const rows=text.replace(/\r/g,'').split('\n');
      const lines=rows.map(splitSmart);

      // detect pars
      const detected = detectBothParsFromLines(lines);

      // Summary table: players
      let playerHeaderRow=-1;
      for(let i=0;i<lines.length;i++){
        if((lines[i][0]||'')==='Name' && (lines[i][1]||'')==='Hdcp'){ playerHeaderRow=i; break; }
      }
      const players=[];
      if(playerHeaderRow>=0){
        for(let i=playerHeaderRow+1;i<lines.length;i++){
          const name=(lines[i][0]||'').trim();
          if(!name) break;
          if(/^(team(\s*\d+)?)$/i.test(name)||/^team average$/i.test(name)||/^stableford$/i.test(name)) continue;
          const hcap=parseFloat((lines[i][1]||'').trim());
          if(!Number.isNaN(hcap)) players.push({name,handicap:hcap,gender:'M'});
        }
      }

      // Gender detection from detailed rows
      const genderMap={};
      for(let i=0;i<lines.length;i++){
        const nm=(lines[i][0]||'').trim(); if(!nm) continue;
        const tee=String(lines[i][1]||'').toLowerCase();
        if(/women|ladies/.test(tee)) genderMap[nm]='F';
        else if(genderMap[nm]==null) genderMap[nm]='M';
      }
      players.forEach(p=>{ if(genderMap[p.name]) p.gender=genderMap[p.name]; });

      // Totals table (Stableford section)
      let stablefordSectionRow=-1;
      for(let i=0;i<lines.length;i++){ if((lines[i][0]||'')==='Stableford'){ stablefordSectionRow=i; break; } }
      const totals={};
      if(stablefordSectionRow>=0){
        for(let i=stablefordSectionRow+2;i<lines.length;i++){
          const nm=(lines[i][0]||'').trim();
          if(!nm) break;
          if(/^(team(\s*\d+)?)$/i.test(nm)||/^team average$/i.test(nm)||/^stableford$/i.test(nm)) continue;
          const r1=parseFloat((lines[i][1]||'').trim());
          if(!Number.isNaN(r1)) totals[nm]=r1;
        }
      }

      // Per-hole pulls (detail card)
      const holeData={};
      for(let p=0;p<players.length;p++){
        const nm=players[p].name;
        for(let i=0;i<lines.length-1;i++){
          const isPlayerRow = (lines[i][0]||'').trim()===nm;
          let nextHasStableford=false;
          if(Array.isArray(lines[i+1])){
            if(String(lines[i+1][1]||'').trim()==='Stableford') nextHasStableford=true;
            else{ for(let k=0;k<lines[i+1].length;k++){ if(String(lines[i+1][k]||'').trim()==='Stableford'){ nextHasStableford=true; break; } } }
          }
          if(isPlayerRow && nextHasStableford){
            const perHole=readStablefordPerHole(lines[i+1]||[]);
            if(perHole){
              const back9=perHole.slice(9).reduce((a,b)=>a+(Number(b)||0),0);
              holeData[nm]={perHole,back9};
            }else{
              holeData[nm]={perHole:Array(18).fill(0),back9:0};
            }
            break;
          }
        }
      }

      return {
        detectedMen: detected.men,
        detectedWomen: detected.women,
        players: players.map(p=>({
          name:p.name,
          gender:p.gender,
          handicap:p.handicap,
          points: totals[p.name]||0,
          back9: holeData[p.name]?holeData[p.name].back9:0,
          perHole: holeData[p.name]?holeData[p.name].perHole:[]
        }))
      };
    }

    // ---------- Ratings helpers ----------
    const defaultMen=[4,4,3,4,5,4,3,4,4, 4,5,4,3,4,4,5,3,4];
    const defaultWomen=[4,4,3,4,5,4,3,4,4, 4,4,5,3,4,4,5,3,4];
    const ratingLabel = avg => avg>=3?'Excellent':avg>=2.5?'Good':avg>=2?'Solid':avg>=1.5?'Needs work':'Struggle';
    const ratingColor = avg => avg>=3?'text-emerald-700':avg>=2.5?'text-emerald-600':avg>=2?'text-neutral-700':avg>=1.5?'text-amber-700':'text-red-700';

    function eventParAverages(perHole, pars){
      let sums={3:{s:0,c:0},4:{s:0,c:0},5:{s:0,c:0}};
      for(let i=0;i<Math.min(18,perHole.length);i++){
        const pts=Number(perHole[i])||0;
        const par=Number(pars[i])||4;
        if(sums[par]){ sums[par].s+=pts; sums[par].c++; }
      }
      const avg=t=>sums[t].c? (sums[t].s/sums[t].c) : 0;
      return {p3:avg(3),p4:avg(4),p5:avg(5)};
    }

    // ---------- App ----------
    function App(){
      const [players,setPlayers]=useState([]);
      const [eventName,setEventName]=useState("Den Society Meeting");
      const [dateStr,setDateStr]=useState(()=>new Date().toISOString().slice(0,10));

      // Pars: detected + manual overrides (Men/Women)
      const [detectedMen,setDetectedMen]=useState(null);
      const [detectedWomen,setDetectedWomen]=useState(null);
      const [useDetected,setUseDetected]=useState(true);

      const [parsMenStr,setParsMenStr]=useState(localStorage.getItem('den_pars_men')||defaultMen.join(','));
      const [parsWomenStr,setParsWomenStr]=useState(localStorage.getItem('den_pars_women')||defaultWomen.join(','));

      const manualMen=useMemo(()=>{
        try{ const arr=parsMenStr.split(',').map(s=>parseInt(s.trim(),10)).filter(Number.isFinite); return arr.length===18?arr:defaultMen; }
        catch(e){ return defaultMen; }
      },[parsMenStr]);
      const manualWomen=useMemo(()=>{
        try{ const arr=parsWomenStr.split(',').map(s=>parseInt(s.trim(),10)).filter(Number.isFinite); return arr.length===18?arr:defaultWomen; }
        catch(e){ return defaultWomen; }
      },[parsWomenStr]);

      const effectiveMen  = useMemo(()=> (useDetected && detectedMen && detectedMen.length===18) ? detectedMen : manualMen, [useDetected,detectedMen,manualMen]);
      const effectiveWomen= useMemo(()=> (useDetected && detectedWomen && detectedWomen.length===18) ? detectedWomen : manualWomen, [useDetected,detectedWomen,manualWomen]);

      async function importCSV(file){
        const text=await file.text();
        const parsed=parseSquabbitCSV(text);
        setPlayers(parsed.players||[]);
        setDetectedMen(parsed.detectedMen||null);
        setDetectedWomen(parsed.detectedWomen||null);
        if(parsed.detectedMen) setUseDetected(true);
      }

      // Event table (rank/points/next handicap – local only)
      const computed=useMemo(()=>{
        const rows=players.map((p,i)=>({idx:i,name:p.name,gender:p.gender,startExact:p.handicap,points:p.points,back9:p.back9,perHole:p.perHole}));
        const base=[].concat(rows).sort((a,b)=>(b.points-a.points)||(b.back9-a.back9));
        if(!base.length) return [];
        // tie groups
        const groups=[], used=new Set();
        for(let i=0;i<base.length;i++){
          if(used.has(base[i].idx)) continue;
          const grp=base.filter(r=>r.points===base[i].points).map(r=>r.idx);
          grp.forEach(id=>used.add(id)); groups.push(grp);
        }
        let pos=1; const out=[]; const winnerIdx=base[0].idx;
        for(let g=0;g<groups.length;g++){
          const start=pos; const ptsValue=POINTS_TABLE[start-1]||0;
          for(let gi=0;gi<groups[g].length;gi++){
            const id=groups[g][gi]; const r=rows.find(x=>x.idx===id);
            const res=computeNewExactHandicap(r.startExact,r.gender,r.points,r.back9,id===winnerIdx);
            out.push({...r,position:start,leaguePoints:ptsValue,isWinner:id===winnerIdx,...res});
          }
          pos+=groups[g].length;
        }
        return out.sort((a,b)=>a.position-b.position);
      },[players]);

      // Ratings (uses Men/Women pars per player)
      const ratings=useMemo(()=>{
        const out=[];
        for(let i=0;i<players.length;i++){
          const p=players[i];
          const pars=(p.gender==='F')?effectiveWomen:effectiveMen;
          const {p3,p4,p5}=eventParAverages(p.perHole||[], pars);
          out.push({
            name:p.name,
            p3:to1(p3),p4:to1(p4),p5:to1(p5),
            r3:ratingLabel(p3),r4:ratingLabel(p4),r5:ratingLabel(p5),
            c3:ratingColor(p3),c4:ratingColor(p4),c5:ratingColor(p5),
            total:p3+p4+p5
          });
        }
        return out.sort((a,b)=> b.total-a.total || a.name.localeCompare(b.name));
      },[players,effectiveMen,effectiveWomen]);

      // Field avgs by gender (for context)
      const fieldAvg=useMemo(()=>{
        let s3m=0,c3m=0,s4m=0,c4m=0,s5m=0,c5m=0;
        let s3f=0,c3f=0,s4f=0,c4f=0,s5f=0,c5f=0;
        for(let i=0;i<players.length;i++){
          const p=players[i]; const perHole=p.perHole||[];
          const pars=(p.gender==='F')?effectiveWomen:effectiveMen;
          for(let h=0;h<Math.min(18,perHole.length);h++){
            const pts=Number(perHole[h])||0; const par=Number(pars[h])||4;
            if(p.gender==='F'){
              if(par===3){s3f+=pts;c3f++;} else if(par===4){s4f+=pts;c4f++;} else if(par===5){s5f+=pts;c5f++;}
            }else{
              if(par===3){s3m+=pts;c3m++;} else if(par===4){s4m+=pts;c4m++;} else if(par===5){s5m+=pts;c5m++;}
            }
          }
        }
        const avg=(s,c)=>c?to1(s/c):0;
        return { men:{p3:avg(s3m,c3m),p4:avg(s4m,c4m),p5:avg(s5m,c5m)},
                 women:{p3:avg(s3f,c3f),p4:avg(s4f,c4f),p5:avg(s5f,c5f)} };
      },[players,effectiveMen,effectiveWomen]);

      // UI helpers
      const chip=(label)=>(<span className="chip mono">{label}</span>);

      return (
        <div className="min-h-screen p-4 sm:p-6 md:p-8">
          <div className="max-w-6xl mx-auto space-y-6">

            {/* Header */}
            <header className="flex flex-col md:flex-row md:items-end gap-3 justify-between">
              <div>
                <h1 className="text-2xl md:text-3xl font-bold tracking-tight">Den Society — League & Eclectic</h1>
                <p className="text-xs text-neutral-500">Offline build (no Supabase) to verify ratings & pars.</p>
              </div>
              <div className="flex gap-2 items-center">
                <input className="px-3 py-2 rounded-xl border border-neutral-300 bg-white" value={eventName} onChange={e=>setEventName(e.target.value)} />
                <input type="date" className="px-3 py-2 rounded-xl border border-neutral-300 bg-white" value={dateStr} onChange={e=>setDateStr(e.target.value)} />
                <label className="px-3 py-2 rounded-xl border border-neutral-300 bg-white cursor-pointer">Import Squabbit CSV
                  <input type="file" accept=".csv" className="hidden" onChange={e=>{const f=e.target.files&&e.target.files[0];if(f)importCSV(f);}} />
                </label>
              </div>
            </header>

            {/* Event table */}
            <section className="bg-white rounded-2xl shadow-sm p-4 md:p-6">
              <div className="flex justify-between mb-4">
                <h2 className="text-lg font-semibold">Event Players</h2>
                <button
                  onClick={()=>{
                    const rows=[["Event",eventName,"Date",dateStr],[],
                      ["Name","Gender","Exact","Stableford","Back9","Pos","Pts","NextExact","NextPlay"],
                      ...computed.map(r=>[r.name,r.gender,Math.round(r.startExact),r.points,r.back9,r.position,r.leaguePoints,r.nextExact.toFixed(1),r.nextPlaying])
                    ];
                    downloadCSV(`DenSociety_${dateStr.replace(/-/g,'')}.csv`,rows);
                  }}
                  className="px-4 py-2 rounded-xl bg-black text-white disabled:opacity-40"
                  disabled={!players.length}
                >Export Event CSV</button>
              </div>
              <div className="overflow-auto">
                <table className="min-w-full text-sm">
                  <thead>
                    <tr className="border-b text-left"><th>#</th><th>Name</th><th>Gender</th><th>Handicap</th><th>Stableford</th><th>Back9</th><th>Pts</th><th>Next PH</th></tr>
                  </thead>
                  <tbody>
                    {!players.length && (<tr><td colSpan="8" className="py-3 text-neutral-500">Import a Squabbit CSV to see the event.</td></tr>)}
                    {computed.map((r,i)=>(
                      <tr key={i} className="border-b">
                        <td>{r.position}</td>
                        <td>{r.name}</td>
                        <td>{r.gender}</td>
                        <td>{Math.round(r.startExact)}</td>
                        <td>{r.points}</td>
                        <td>{r.back9}</td>
                        <td>{r.leaguePoints}</td>
                        <td>{r.nextPlaying}</td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
              <p className="text-xs text-neutral-500 mt-2">Ties share the highest available slot. Countback uses Back-9 from the detailed card.</p>
            </section>

            {/* Eclectic (local only, for sanity) */}
            <section className="bg-white rounded-2xl shadow-sm p-4 md:p-6">
              <div className="flex justify-between mb-4">
                <h2 className="text-lg font-semibold">Eclectic Leaderboard</h2>
                <button
                  onClick={()=>{
                    const list = players.map(p=>({
                      name:p.name,
                      bestPerHole:(p.perHole||[]), // this build only has current event; season omitted intentionally
                      eclecticTotal:(p.perHole||[]).reduce((a,b)=>a+(Number(b)||0),0)
                    })).sort((a,b)=> (b.eclecticTotal - a.eclecticTotal) || a.name.localeCompare(b.name));
                    const header=["Rank","Name","Eclectic Total",...Array.from({length:18},(_,i)=>`H${i+1}`)];
                    const rows=[header, ...list.map((r,i)=>[i+1,r.name,r.eclecticTotal,...(r.bestPerHole||Array(18).fill(0))])];
                    downloadCSV(`DenSociety_Eclectic_${dateStr.replace(/-/g,'')}.csv`,rows);
                  }}
                  className="px-3 py-2 rounded-2xl bg-black text-white"
                  disabled={!players.length}
                >Export Eclectic CSV</button>
              </div>
              <div className="overflow-auto">
                <table className="min-w-full text-sm mono">
                  <thead>
                    <tr className="border-b text-left">
                      <th>Rank</th><th>Name</th><th>Eclectic Total</th>
                      {Array.from({length:18},(_,i)=>(<th key={i}>H{i+1}</th>))}
                    </tr>
                  </thead>
                  <tbody>
                    {players.length===0 && (<tr><td colSpan="21" className="py-3 text-neutral-500">Import a CSV to see eclectic.</td></tr>)}
                    {players.map((p,idx)=>{
                      const per=p.perHole||Array(18).fill(0);
                      const total=per.reduce((a,b)=>a+(Number(b)||0),0);
                      return (
                        <tr key={p.name} className="border-b">
                          <td>{idx+1}</td>
                          <td>{p.name}</td>
                          <td>{total}</td>
                          {per.map((v,i)=><td key={i}>{v}</td>)}
                        </tr>
                      );
                    })}
                  </tbody>
                </table>
              </div>
              <p className="text-xs text-neutral-500 mt-2">This offline build shows eclectic for the imported event only (season rollup removed to keep it bullet-proof).</p>
            </section>

            {/* Ratings — shows MEN & WOMEN pars at the top */}
            <section className="bg-white rounded-2xl shadow-sm p-4 md:p-6">
              <div className="flex items-center justify-between mb-3">
                <h2 className="text-lg font-semibold">Ratings — Par 3 / Par 4 / Par 5 (This Event)</h2>
                <button
                  className="px-3 py-2 rounded-2xl bg-black text-white disabled:opacity-40"
                  disabled={!ratings.length}
                  onClick={()=>{
                    const rows=[["Name","Par-3 avg","Par-3 rating","Par-4 avg","Par-4 rating","Par-5 avg","Par-5 rating"]];
                    rows.push(["FIELD (Men)", fieldAvg.men.p3, ratingLabel(fieldAvg.men.p3), fieldAvg.men.p4, ratingLabel(fieldAvg.men.p4), fieldAvg.men.p5, ratingLabel(fieldAvg.men.p5)]);
                    rows.push(["FIELD (Women)", fieldAvg.women.p3, ratingLabel(fieldAvg.women.p3), fieldAvg.women.p4, ratingLabel(fieldAvg.women.p4), fieldAvg.women.p5, ratingLabel(fieldAvg.women.p5)]);
                    ratings.forEach(r=>rows.push([r.name,r.p3,r.r3,r.p4,r.r4,r.p5,r.r5]));
                    downloadCSV(`DenSociety_EventRatings_${dateStr.replace(/-/g,'')}.csv`,rows);
                  }}
                >Export Ratings</button>
              </div>

              {/* Pars in use (explicit) */}
              <div className="mb-3">
                <div className="text-xs text-neutral-600 mb-1">H1–H18 Pars in use:</div>
                <div className="mono text-sm overflow-auto">
                  <div className="flex items-center gap-2 mb-1">
                    {chip("Men")} <span>{effectiveMen.join(', ')}</span>
                  </div>
                  <div className="flex items-center gap-2">
                    {chip("Women")} <span>{effectiveWomen.join(', ')}</span>
                  </div>
                </div>
              </div>

              <div className="overflow-auto">
                <table className="min-w-full text-sm">
                  <thead>
                    <tr className="border-b text-left">
                      <th>Name</th>
                      <th>Par-3 avg</th><th>Par-3 rating</th>
                      <th>Par-4 avg</th><th>Par-4 rating</th>
                      <th>Par-5 avg</th><th>Par-5 rating</th>
                    </tr>
                  </thead>
                  <tbody>
                    {ratings.map(r=>(
                      <tr key={r.name} className="border-b">
                        <td className="font-medium">{r.name}</td>
                        <td>{r.p3.toFixed(1)}</td><td className={r.c3}>{r.r3}</td>
                        <td>{r.p4.toFixed(1)}</td><td className={r.c4}>{r.r4}</td>
                        <td>{r.p5.toFixed(1)}</td><td className={r.c5}>{r.r5}</td>
                      </tr>
                    ))}
                    {!ratings.length && (<tr><td colSpan="7" className="py-3 text-neutral-500">Import a CSV to see event ratings.</td></tr>)}
                  </tbody>
                </table>
              </div>

              {/* Owner overrides for pars */}
              <div className="mt-6 border-t pt-4">
                <h3 className="text-sm font-semibold mb-2">Course Setup — Pars for Ratings</h3>
                <label className="flex items-center gap-2 text-sm mb-3">
                  <input type="checkbox" checked={useDetected} onChange={e=>setUseDetected(e.target.checked)} />
                  Use detected pars from CSV (if available)
                </label>
                <div className="grid md:grid-cols-2 gap-3">
                  <div>
                    <label className="text-sm block mb-1">Manual Men pars (18 comma-separated)</label>
                    <input className="w-full border rounded-xl p-2 mono bg-white"
                      value={parsMenStr}
                      onChange={e=>{ setParsMenStr(e.target.value); localStorage.setItem('den_pars_men', e.target.value); }}
                      placeholder="e.g. 5,4,3,4,5,4,3,4,4, 4,3,5,4,4,4,5,3,4" />
                  </div>
                  <div>
                    <label className="text-sm block mb-1">Manual Women pars (18 comma-separated)</label>
                    <input className="w-full border rounded-xl p-2 mono bg-white"
                      value={parsWomenStr}
                      onChange={e=>{ setParsWomenStr(e.target.value); localStorage.setItem('den_pars_women', e.target.value); }}
                      placeholder="e.g. 5,4,3,4,5,4,3,4,4, 4,4,5,3,4,4,5,3,4" />
                  </div>
                </div>
                <p className="text-xs text-neutral-500 mt-2">
                  If the CSV only has one Par row, it will be used for both Men and Women unless you override here.
                </p>
              </div>
            </section>

          </div>
        </div>
      );
    }

    const root=ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
